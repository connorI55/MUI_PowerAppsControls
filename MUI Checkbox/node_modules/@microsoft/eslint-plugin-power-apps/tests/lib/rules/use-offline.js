// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.

"use strict";

//------------------------------------------------------------------------------
// Requirements
//------------------------------------------------------------------------------

const rule = require("../../../lib/rules/use-offline");
const RuleTester = require("eslint").RuleTester;

//------------------------------------------------------------------------------
// Helpers
//------------------------------------------------------------------------------

const ruleTester = new RuleTester();
const MESSAGE_ID = "message2";

ruleTester.run("use-offline", rule, {
    valid: [
        "var myFakeApiCall = Xrm.Fake.offline.isOfflineEnabled('entityType');"
    ],
    invalid: [
        {
            code: "var offlineMobile = Xrm.Mobile.offline;",
            errors: [{ messageId: MESSAGE_ID, line: 1 }]
        },
        {
            code: "var isOfflineEnabled = Xrm.Mobile.offline.isOfflineEnabled('entityType');",
            errors: [{ messageId: MESSAGE_ID, line: 1 }]
        },
        {
            code: "var fullWindowOfflineEnabled = window.Xrm.Mobile.offline.createRecord('entityType', dataObject);",
            errors: [{ messageId: MESSAGE_ID, line: 1 }]
        }
    ]
});
