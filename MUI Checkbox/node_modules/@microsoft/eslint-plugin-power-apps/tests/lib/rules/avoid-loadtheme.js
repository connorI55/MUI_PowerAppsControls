// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.

"use strict";

//------------------------------------------------------------------------------
// Requirements
//------------------------------------------------------------------------------

const rule = require("../../../lib/rules/avoid-loadtheme");
const RuleTester = require("eslint").RuleTester;

//------------------------------------------------------------------------------
// CONSTANTS
//------------------------------------------------------------------------------

const MESSAGE_ID_LOAD_THEME_GLOBAL_FUNC = "message1";

//------------------------------------------------------------------------------
// Helpers
//------------------------------------------------------------------------------

const ruleTester = new RuleTester();

ruleTester.run("avoid-loadtheme", rule, {
  valid: [
    {
      code:
        `
                var appTheme = createTheme({
                  palette: {
                    themePrimary: 'red'
                  }
                });

                var App = "<div>App content ...</div>";
            `
    }
  ],
  invalid: [
    // Use of the loadTheme API
    {
      code:
        `// INVALID: Use of the loadTheme API

                var appTheme = createTheme({
                  palette: {
                    themePrimary: 'red'
                  }
                });

                loadTheme(appTheme);

                var App = "<div>App content ...</div>";
            `,
      errors: [
        { messageId: MESSAGE_ID_LOAD_THEME_GLOBAL_FUNC, line: 9 },
      ]
    }
  ]
});
