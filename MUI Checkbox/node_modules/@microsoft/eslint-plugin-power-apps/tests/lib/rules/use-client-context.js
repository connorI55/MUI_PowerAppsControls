// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.

"use strict";

//------------------------------------------------------------------------------
// Requirements
//------------------------------------------------------------------------------

const rule = require("../../../lib/rules/use-client-context");
const RuleTester = require("eslint").RuleTester;

//------------------------------------------------------------------------------
// Helpers
//------------------------------------------------------------------------------

const ruleTester = new RuleTester();

ruleTester.run("use-client-context", rule, {
    valid: [],
    invalid: [
        // XrmPage
        {
            code:
            `    // INVALID: XrmPage            
            Xrm.Page.data.entity.attributes.getByName('telephone1').setValue("zzz");            
            var telephoneAttr = Xrm.Page.data.entity.attributes.getByName('telephone1').getValue();
            var firstName = Xrm.Page.getAttribute("firstname").getValue();

            var page = Xrm.Page;
            page.context.client = myClientObject;
            `,
            errors: [
                { line: 2 },
                { line: 3 },
                { line: 4 },
                { line: 6 }
            ]
        }
    ]
});
